import { useState } from 'react';
import { useTranslation } from 'react-i18next';
import axios from 'axios';
import { 
  Chart, 
  AlgorithmHeader, 
  InteractiveExperiment,
  ExperimentPanel,
  ParameterControl,
  ResultCard
} from '@common/modules/MDX/MDXComponents';
import { DatasetInfo, DatasetPreview, useDataset } from '@modules/Datasets';
import { useLogger } from '@common/modules/Logger';
import { useExceptions, ExceptionType, ExceptionSeverity } from '@common/modules/Exceptions';
import { Database, Settings, TrendingUp } from 'lucide-react';

export const LinearRegressionDemo = () => {
  const { t } = useTranslation();
  const logger = useLogger();
  const { captureException } = useExceptions();
  
  // å›ºå®šä½¿ç”¨åŠ å·æˆ¿ä»·æ•°æ®é›†
  const FIXED_DATASET = 'california_housing';
  
  const [learningRate, setLearningRate] = useState(0.01);
  const [iterations, setIterations] = useState(1000);
  const [loading, setLoading] = useState(false);
  const [result, setResult] = useState(null);
  
  // ä½¿ç”¨ Datasets æ¨¡å—åŠ è½½æ•°æ®é›†
  const { dataset, loading: loadingDataset, error: datasetError } = useDataset(FIXED_DATASET);

  const runTraining = async () => {
    setLoading(true);
    logger.info('å¼€å§‹è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹', { dataset: FIXED_DATASET, learningRate, iterations });
    
    try {
      const response = await axios.post('/api/algorithms/supervised/linear-regression/train', {
        dataset: FIXED_DATASET,
        learning_rate: learningRate,
        iterations: iterations,
      });
      setResult(response.data);
      logger.info('çº¿æ€§å›å½’æ¨¡å‹è®­ç»ƒæˆåŠŸ', { result: response.data });
    } catch (error) {
      logger.error('çº¿æ€§å›å½’æ¨¡å‹è®­ç»ƒå¤±è´¥', { error: error.message, dataset: FIXED_DATASET, learningRate, iterations });
      captureException(error, {
        type: ExceptionType.NETWORK,
        severity: ExceptionSeverity.HIGH,
        context: { 
          algorithm: 'linear-regression',
          dataset: FIXED_DATASET,
          learningRate,
          iterations,
          message: 'è®­ç»ƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ'
        }
      });
    } finally {
      setLoading(false);
    }
  };

  const resetParameters = () => {
    setLearningRate(0.01);
    setIterations(1000);
    setResult(null);
  };

  return (
    <InteractiveExperiment
      description="é€šè¿‡è°ƒæ•´å‚æ•°ï¼Œè§‚å¯Ÿçº¿æ€§å›å½’æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹å’Œæ‹Ÿåˆæ•ˆæœ"
      onRun={runTraining}
      onReset={resetParameters}
      loading={loading}
      result={result && (
        <>
          <ResultCard title="ğŸ“ˆ è®­ç»ƒç»“æœ" variant="success" className="mb-4">
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
              <div className="bg-white p-3 rounded-lg border">
                <div className="text-sm text-gray-600">æ¨¡å‹ç³»æ•° (w)</div>
                <div className="text-lg font-semibold">{result.coefficients?.toFixed(4)}</div>
              </div>
              <div className="bg-white p-3 rounded-lg border">
                <div className="text-sm text-gray-600">æˆªè· (b)</div>
                <div className="text-lg font-semibold">{result.intercept?.toFixed(4)}</div>
              </div>
              <div className="bg-white p-3 rounded-lg border">
                <div className="text-sm text-gray-600">RÂ² Score</div>
                <div className="text-lg font-semibold">{result.r2_score?.toFixed(4)}</div>
              </div>
              <div className="bg-white p-3 rounded-lg border">
                <div className="text-sm text-gray-600">MSE</div>
                <div className="text-lg font-semibold">{result.mse?.toFixed(4)}</div>
              </div>
            </div>
          </ResultCard>

          {result.plot_data && (
            <ResultCard title="ğŸ“Š æ‹Ÿåˆå¯è§†åŒ–" variant="info">
              <Chart
                data={result.plot_data}
                layout={{
                  title: 'çº¿æ€§å›å½’æ‹Ÿåˆç»“æœ',
                  xaxis: { title: 'X' },
                  yaxis: { title: 'Y' },
                  height: 400,
                }}
              />
            </ResultCard>
          )}
        </>
      )}
    >
      {/* æ•°æ®é›†ä¸ç‰¹å¾è¯´æ˜ */}
      <ExperimentPanel icon={Database}>
        <DatasetInfo datasetName={FIXED_DATASET} />
        
        {datasetError && (
          <div className="mt-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-red-700 dark:text-red-300 text-sm">
            âš ï¸ {datasetError}
          </div>
        )}
        
        {/* ç‰¹å¾è¯´æ˜ */}
        <div className="mt-4 space-y-4 text-sm">
          <div>
            <div className="font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2">
              <span className="text-lg">ğŸ¯</span>
              é¢„æµ‹ç›®æ ‡
            </div>
            <div className="ml-6 space-y-1 text-gray-700 dark:text-gray-300">
              <div className="flex items-center gap-2">
                <span className="font-mono bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-200 px-2 py-1 rounded text-xs font-medium">MEDV</span>
                <span>- æˆ¿å±‹ä»·æ ¼ä¸­ä½æ•°ï¼ˆå•ä½ï¼šåä¸‡ç¾å…ƒï¼‰</span>
              </div>
            </div>
          </div>
          
          <div className="border-t border-gray-200 dark:border-gray-700 pt-4">
            <div className="font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2">
              <span className="text-lg">ğŸ“Š</span>
              è¾“å…¥ç‰¹å¾
            </div>
            <div className="ml-6 grid grid-cols-1 sm:grid-cols-2 gap-2 text-gray-700 dark:text-gray-300">
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">MedInc</span>
                <span>- è¡—åŒºæ”¶å…¥ä¸­ä½æ•°</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">HouseAge</span>
                <span>- æˆ¿å±‹å¹´é¾„ä¸­ä½æ•°</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">AveRooms</span>
                <span>- å¹³å‡æˆ¿é—´æ•°</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">AveBedrms</span>
                <span>- å¹³å‡å§å®¤æ•°</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">Population</span>
                <span>- è¡—åŒºäººå£æ•°</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">AveOccup</span>
                <span>- å¹³å‡å…¥ä½ç‡</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">Latitude</span>
                <span>- çº¬åº¦</span>
              </div>
              <div className="flex items-center gap-2">
                <span className="font-mono bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-xs font-medium">Longitude</span>
                <span>- ç»åº¦</span>
              </div>
            </div>
          </div>
          
          <div className="border-t border-gray-200 dark:border-gray-700 pt-4">
            <div className="font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2">
              <span className="text-lg">ğŸ’¡</span>
              å®éªŒç›®æ ‡
            </div>
            <div className="ml-6 text-gray-700 dark:text-gray-300">
              ä½¿ç”¨ <strong className="text-gray-900 dark:text-gray-100">8 ä¸ªç‰¹å¾</strong> é¢„æµ‹åŠ å·åœ°åŒºæˆ¿å±‹ä»·æ ¼ï¼Œæ¢ç´¢ç‰¹å¾ä¸æˆ¿ä»·ä¹‹é—´çš„çº¿æ€§å…³ç³»
            </div>
          </div>
        </div>
        
        <DatasetPreview datasetName={FIXED_DATASET} maxRows={5} className="mt-4" />
      </ExperimentPanel>

      {/* å‚æ•°è°ƒæ•´é¢æ¿ */}
      <ExperimentPanel title="ğŸ›ï¸ å‚æ•°è°ƒæ•´" icon={Settings}>
        {/* é¢„è®¾é…ç½®æŒ‰é’® */}
        <div className="mb-6">
          <div className="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">å¿«é€Ÿé…ç½®</div>
          <div className="flex flex-wrap gap-2">
            <button
              onClick={() => {
                setLearningRate(0.01);
                setIterations(1000);
                setTimeout(() => runTraining(), 100);
              }}
              className="px-3 py-2 bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200 rounded-lg text-sm font-medium hover:bg-blue-200 dark:hover:bg-blue-900/60 transition-colors"
            >
              ğŸš€ å¿«é€Ÿå¼€å§‹ (æ¨è)
            </button>
            <button
              onClick={() => {
                setLearningRate(0.005);
                setIterations(2000);
                setTimeout(() => runTraining(), 100);
              }}
              className="px-3 py-2 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-200 rounded-lg text-sm font-medium hover:bg-green-200 dark:hover:bg-green-900/60 transition-colors"
            >
              ğŸ¯ ç²¾ç¡®è®­ç»ƒ
            </button>
            <button
              onClick={() => {
                setLearningRate(0.02);
                setIterations(500);
                setTimeout(() => runTraining(), 100);
              }}
              className="px-3 py-2 bg-orange-100 dark:bg-orange-900/40 text-orange-800 dark:text-orange-200 rounded-lg text-sm font-medium hover:bg-orange-200 dark:hover:bg-orange-900/60 transition-colors"
            >
              âš¡ å¿«é€Ÿè®­ç»ƒ
            </button>
          </div>
        </div>

        {/* å‚æ•°è§£é‡Š */}
        <div className="mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800">
          <div className="text-sm font-medium text-blue-900 dark:text-blue-100 mb-3">ğŸ’¡ å‚æ•°å«ä¹‰è§£é‡Š</div>
          <div className="space-y-3 text-sm text-blue-800 dark:text-blue-200">
            <div>
              <span className="font-semibold">å­¦ä¹ ç‡</span>ï¼šæƒ³è±¡æˆ"è°ƒæ•´çš„å¹…åº¦"
              <div className="mt-1 pl-3 text-xs">
                â€¢ å¤ªå¤§ â†’ åƒç”¨åŠ›è¿‡çŒ›ï¼Œå¯èƒ½è¶Šè°ƒè¶Šå ğŸƒâ€â™‚ï¸ğŸ’¨<br/>
                â€¢ å¤ªå° â†’ åƒå°ç¢æ­¥ï¼Œè°ƒæ•´é€Ÿåº¦å¾ˆæ…¢ ğŸ¢<br/>
                â€¢ åˆšå¥½ â†’ ç¨³å®šåˆé«˜æ•ˆ âœ¨
              </div>
            </div>
            <div>
              <span className="font-semibold">è¿­ä»£æ¬¡æ•°</span>ï¼šæƒ³è±¡æˆ"ç»ƒä¹ çš„æ¬¡æ•°"
              <div className="mt-1 pl-3 text-xs">
                â€¢ å¤ªå°‘ â†’ è¿˜æ²¡å­¦ä¼šå°±åœäº† ğŸ“<br/>
                â€¢ å¤ªå¤š â†’ è¿‡åº¦ç»ƒä¹ ï¼Œæ­»è®°ç¡¬èƒŒ ğŸ“š<br/>
                â€¢ åˆšå¥½ â†’ å……åˆ†å­¦ä¹ ï¼Œä¸¾ä¸€åä¸‰ ğŸ¯
              </div>
            </div>
          </div>
        </div>

        {/* æ‰‹åŠ¨è°ƒæ•´ */}
        <div className="space-y-4">
          <div className="text-sm font-medium text-gray-700 dark:text-gray-300">æ‰‹åŠ¨è°ƒæ•´</div>
          
          <ParameterControl
            label="å­¦ä¹ ç‡ (æ¯æ¬¡è°ƒæ•´çš„å¹…åº¦)"
            description="æ•°å€¼è¶Šå¤§ï¼Œæ¯æ¬¡è°ƒæ•´è¶Šå¤§ï¼›æ•°å€¼è¶Šå°ï¼Œæ¯æ¬¡è°ƒæ•´è¶Šå°"
            value={learningRate}
            onChange={(value) => {
              setLearningRate(value);
              // å‚æ•°å˜åŒ–æ—¶è‡ªåŠ¨è¿è¡Œ
              setTimeout(() => runTraining(), 300);
            }}
            min={0.001}
            max={0.1}
            step={0.001}
            recommendedValue={0.01}
            recommendedReason="0.01 æ˜¯ä¸€ä¸ªç¨³å®šåˆé«˜æ•ˆçš„å€¼ï¼Œé€‚åˆåˆå­¦è€…"
          />
          
          <ParameterControl
            label="è¿­ä»£æ¬¡æ•° (ç»ƒä¹ å¤šå°‘æ¬¡)"
            description="æ¨¡å‹ä¼šç»ƒä¹ è¿™ä¹ˆå¤šæ¬¡æ¥å­¦ä¼šé¢„æµ‹è§„å¾‹"
            value={iterations}
            onChange={(value) => {
              setIterations(value);
              // å‚æ•°å˜åŒ–æ—¶è‡ªåŠ¨è¿è¡Œ
              setTimeout(() => runTraining(), 300);
            }}
            min={100}
            max={5000}
            step={100}
            recommendedValue={1000}
            recommendedReason="1000 æ¬¡é€šå¸¸è¶³å¤Ÿå­¦ä¼šè§„å¾‹ï¼Œåˆä¸ä¼šè¿‡åº¦ç»ƒä¹ "
          />
        </div>
      </ExperimentPanel>
    </InteractiveExperiment>
  );
};

<AlgorithmHeader 
  title="çº¿æ€§å›å½’ Linear Regression"
  difficulty="beginner"
  stars={2}
  time={15}
/>

## 1ï¸âƒ£ ç®—æ³•æ¦‚è§ˆ

**çº¿æ€§å›å½’**ï¼ˆLinear Regressionï¼‰æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€åŸºç¡€ã€æœ€é‡è¦çš„ç›‘ç£å­¦ä¹ ç®—æ³•ä¹‹ä¸€ã€‚å®ƒé€šè¿‡æ‹Ÿåˆä¸€æ¡ç›´çº¿ï¼ˆæˆ–é«˜ç»´ç©ºé—´ä¸­çš„è¶…å¹³é¢ï¼‰æ¥å»ºæ¨¡è‡ªå˜é‡ X å’Œå› å˜é‡ Y ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚

### æ ¸å¿ƒæ€æƒ³

- å‡è®¾ç›®æ ‡å€¼ä¸ç‰¹å¾ä¹‹é—´å­˜åœ¨**çº¿æ€§å…³ç³»**
- é€šè¿‡æœ€å°åŒ–é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„**è¯¯å·®å¹³æ–¹å’Œ**æ¥æ‰¾åˆ°æœ€ä¼˜æ‹Ÿåˆç›´çº¿
- ä½¿ç”¨**æ¢¯åº¦ä¸‹é™æ³•**æˆ–**æ­£è§„æ–¹ç¨‹**æ±‚è§£æœ€ä¼˜å‚æ•°

### åº”ç”¨åœºæ™¯

- ğŸ“ˆ **æˆ¿ä»·é¢„æµ‹**ï¼šæ ¹æ®é¢ç§¯ã€ä½ç½®ç­‰ç‰¹å¾é¢„æµ‹æˆ¿ä»·
- ğŸ’° **é”€å”®é¢„æµ‹**ï¼šæ ¹æ®å†å²æ•°æ®é¢„æµ‹æœªæ¥é”€å”®é¢
- ğŸ“Š **è¶‹åŠ¿åˆ†æ**ï¼šåˆ†æå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§å’Œè¶‹åŠ¿
- ğŸŒ¡ï¸ **æ¸©åº¦é¢„æµ‹**ï¼šæ ¹æ®å†å²æ°”æ¸©æ•°æ®é¢„æµ‹æœªæ¥æ¸©åº¦

---

## 2ï¸âƒ£ å‘å±•å†å²

çº¿æ€§å›å½’çš„å†å²å¯ä»¥è¿½æº¯åˆ°19ä¸–çºªåˆï¼š

- **1805å¹´** - æ³•å›½æ•°å­¦å®¶**å‹’è®©å¾·**ï¼ˆAdrien-Marie Legendreï¼‰é¦–æ¬¡æå‡º**æœ€å°äºŒä¹˜æ³•**
- **1809å¹´** - å¾·å›½æ•°å­¦å®¶**é«˜æ–¯**ï¼ˆCarl Friedrich Gaussï¼‰ç‹¬ç«‹å‘ç°å¹¶ç³»ç»ŸåŒ–äº†æœ€å°äºŒä¹˜æ³•
- **1886å¹´** - è‹±å›½ç»Ÿè®¡å­¦å®¶**å¼—æœ—è¥¿æ–¯Â·é«˜å°”é¡¿**ï¼ˆFrancis Galtonï¼‰ç ”ç©¶çˆ¶å­èº«é«˜å…³ç³»æ—¶ï¼Œé¦–æ¬¡ä½¿ç”¨"å›å½’"ï¼ˆRegressionï¼‰ä¸€è¯
- **20ä¸–çºª** - éšç€è®¡ç®—æœºçš„å‘å±•ï¼Œçº¿æ€§å›å½’æˆä¸ºç»Ÿè®¡å­¦å’Œæœºå™¨å­¦ä¹ çš„åŸºçŸ³

---

## 3ï¸âƒ£ æ•°å­¦åŸç†

### æ¨¡å‹è¡¨ç¤º

å¯¹äºå•å˜é‡çº¿æ€§å›å½’ï¼Œæ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸ºï¼š

```math
y = wx + b
```

å¯¹äºå¤šå˜é‡çº¿æ€§å›å½’ï¼š

```math
y = w_1x_1 + w_2x_2 + ... + w_nx_n + b = \mathbf{w}^T\mathbf{x} + b
```

å…¶ä¸­ï¼š
- $y$ æ˜¯é¢„æµ‹å€¼
- $\mathbf{x}$ æ˜¯ç‰¹å¾å‘é‡
- $\mathbf{w}$ æ˜¯æƒé‡å‘é‡
- $b$ æ˜¯åç½®é¡¹ï¼ˆæˆªè·ï¼‰

### æŸå¤±å‡½æ•°

ä½¿ç”¨**å‡æ–¹è¯¯å·®**ï¼ˆMean Squared Error, MSEï¼‰ä½œä¸ºæŸå¤±å‡½æ•°ï¼š

```math
J(\mathbf{w}, b) = \frac{1}{2m}\sum_{i=1}^{m}(h_{\mathbf{w},b}(\mathbf{x}^{(i)}) - y^{(i)})^2
```

### æ¢¯åº¦ä¸‹é™

é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ›´æ–°å‚æ•°ï¼š

```math
w_j := w_j - \alpha \frac{\partial J}{\partial w_j}
```

```math
b := b - \alpha \frac{\partial J}{\partial b}
```

å…¶ä¸­ $\alpha$ æ˜¯å­¦ä¹ ç‡ã€‚

---

## 4ï¸âƒ£ äº¤äº’å¼å®éªŒ âš¡

<LinearRegressionDemo />

---

## 5ï¸âƒ£ ä»£ç å®ç°

### Python å®ç°ï¼ˆä½¿ç”¨ scikit-learnï¼‰

```python
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# ç”Ÿæˆç¤ºä¾‹æ•°æ®
X = np.random.rand(100, 1) * 10
y = 2.5 * X + 1.5 + np.random.randn(100, 1) * 2

# åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# åˆ›å»ºå¹¶è®­ç»ƒæ¨¡å‹
model = LinearRegression()
model.fit(X_train, y_train)

# é¢„æµ‹
y_pred = model.predict(X_test)

# è¯„ä¼°
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"ç³»æ•°: {model.coef_[0][0]:.4f}")
print(f"æˆªè·: {model.intercept_[0]:.4f}")
print(f"MSE: {mse:.4f}")
print(f"RÂ² Score: {r2:.4f}")
```

### ä»é›¶å®ç°æ¢¯åº¦ä¸‹é™

```python
def linear_regression_gradient_descent(X, y, learning_rate=0.01, iterations=1000):
    m, n = X.shape
    w = np.zeros((n, 1))
    b = 0
    
    for i in range(iterations):
        # é¢„æµ‹
        y_pred = X @ w + b
        
        # è®¡ç®—æ¢¯åº¦
        dw = (1/m) * X.T @ (y_pred - y)
        db = (1/m) * np.sum(y_pred - y)
        
        # æ›´æ–°å‚æ•°
        w -= learning_rate * dw
        b -= learning_rate * db
    
    return w, b
```

---

## 6ï¸âƒ£ ä¼˜ç¼ºç‚¹åˆ†æ

### âœ… ä¼˜ç‚¹

- **ç®€å•æ˜“æ‡‚**ï¼šæ¨¡å‹ç»“æ„ç®€å•ï¼Œæ˜“äºç†è§£å’Œå®ç°
- **è®¡ç®—é«˜æ•ˆ**ï¼šè®­ç»ƒå’Œé¢„æµ‹é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®
- **å¯è§£é‡Šæ€§å¼º**ï¼šç³»æ•°ç›´æ¥åæ˜ ç‰¹å¾å¯¹ç›®æ ‡çš„å½±å“ç¨‹åº¦
- **é²æ£’æ€§å¥½**ï¼šå¯¹å¼‚å¸¸å€¼æ•æ„Ÿåº¦ç›¸å¯¹è¾ƒä½ï¼ˆç›¸æ¯”å†³ç­–æ ‘ï¼‰

### âŒ ç¼ºç‚¹

- **çº¿æ€§å‡è®¾**ï¼šåªèƒ½æ‹Ÿåˆçº¿æ€§å…³ç³»ï¼Œæ— æ³•å¤„ç†å¤æ‚çš„éçº¿æ€§æ¨¡å¼
- **ç‰¹å¾å·¥ç¨‹ä¾èµ–**ï¼šéœ€è¦æ‰‹åŠ¨æ„é€ ç‰¹å¾æ¥æ•æ‰éçº¿æ€§å…³ç³»
- **å¤šé‡å…±çº¿æ€§**ï¼šç‰¹å¾ä¹‹é—´é«˜åº¦ç›¸å…³æ—¶ï¼Œæ¨¡å‹ä¸ç¨³å®š
- **å¼‚å¸¸å€¼æ•æ„Ÿ**ï¼šæç«¯å€¼ä¼šæ˜¾è‘—å½±å“æ‹Ÿåˆç»“æœ

---

## 7ï¸âƒ£ å®é™…åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šæ³¢å£«é¡¿æˆ¿ä»·é¢„æµ‹

ä½¿ç”¨æˆ¿å±‹é¢ç§¯ã€æˆ¿é—´æ•°é‡ã€çŠ¯ç½ªç‡ç­‰13ä¸ªç‰¹å¾é¢„æµ‹æˆ¿ä»·ï¼š

```python
from sklearn.datasets import load_boston
from sklearn.preprocessing import StandardScaler

# åŠ è½½æ•°æ®
boston = load_boston()
X, y = boston.data, boston.target

# æ ‡å‡†åŒ–ç‰¹å¾
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# è®­ç»ƒæ¨¡å‹
model = LinearRegression()
model.fit(X_scaled, y)

# ç‰¹å¾é‡è¦æ€§åˆ†æ
feature_importance = pd.DataFrame({
    'feature': boston.feature_names,
    'coefficient': model.coef_
}).sort_values('coefficient', key=abs, ascending=False)
```

### æ¡ˆä¾‹2ï¼šå¹¿å‘ŠæŠ•å…¥ä¸é”€å”®é¢

åˆ†æç”µè§†ã€å¹¿æ’­ã€æŠ¥çº¸å¹¿å‘ŠæŠ•å…¥å¯¹é”€å”®é¢çš„å½±å“ï¼š

```python
# å¤šå…ƒçº¿æ€§å›å½’
# y = w1*TV + w2*Radio + w3*Newspaper + b

model = LinearRegression()
model.fit(advertising_data[['TV', 'Radio', 'Newspaper']], 
          advertising_data['Sales'])

print(f"TVç³»æ•°: {model.coef_[0]:.4f}")
print(f"Radioç³»æ•°: {model.coef_[1]:.4f}")
print(f"Newspaperç³»æ•°: {model.coef_[2]:.4f}")
```

---

## 8ï¸âƒ£ æ‰©å±•é˜…è¯»

- **Ridgeå›å½’ï¼ˆå²­å›å½’ï¼‰**ï¼šæ·»åŠ  L2 æ­£åˆ™åŒ–ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ
- **Lassoå›å½’**ï¼šæ·»åŠ  L1 æ­£åˆ™åŒ–ï¼Œå®ç°ç‰¹å¾é€‰æ‹©
- **å¤šé¡¹å¼å›å½’**ï¼šé€šè¿‡å¤šé¡¹å¼ç‰¹å¾æ‰©å±•æ•æ‰éçº¿æ€§å…³ç³»
- **å±€éƒ¨åŠ æƒå›å½’**ï¼šå¯¹ä¸åŒåŒºåŸŸèµ‹äºˆä¸åŒæƒé‡

---

## ğŸ¯ å…³é”®è¦ç‚¹

1. çº¿æ€§å›å½’å‡è®¾ç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´å­˜åœ¨**çº¿æ€§å…³ç³»**
2. é€šè¿‡**æœ€å°äºŒä¹˜æ³•**æˆ–**æ¢¯åº¦ä¸‹é™æ³•**æ±‚è§£æœ€ä¼˜å‚æ•°
3. **å­¦ä¹ ç‡**å’Œ**è¿­ä»£æ¬¡æ•°**æ˜¯å½±å“è®­ç»ƒæ•ˆæœçš„é‡è¦è¶…å‚æ•°
4. æ¨¡å‹ç®€å•é«˜æ•ˆï¼Œä½†åªé€‚ç”¨äºçº¿æ€§æˆ–è¿‘ä¼¼çº¿æ€§çš„é—®é¢˜
5. å¯ä»¥é€šè¿‡**ç‰¹å¾å·¥ç¨‹**å’Œ**æ­£åˆ™åŒ–**æå‡æ¨¡å‹æ€§èƒ½

